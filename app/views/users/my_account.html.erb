<div id="blue">
  <div class="container">
    <div class="row centered">
      <div class="col-lg-8 col-lg-offset-2">
        <h4><b>My account</b></h4>
        <p>account info</p>

      <center>
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#createSlideShoeModal">Create new Slideshow</button>
      </center>
      </div>
    </div><!-- row -->
  </div><!-- container -->
</div><!-- blue wrap -->

<div class="container">
  <div class="row centered">
    <div class="col-lg-8">
      <h1>My Slideshows</h1>
      <div class="current_slideshows slideshow_list_sect_container">
        <%= render :partial => '/slideshows/slideshow_list_sect', :locals => { :slideshows => current_user.slideshows.paginate(:page => 1), :context_page => 'account' } %>
      </div>
    </div>
  </div><!-- row -->
</div><!-- container -->


<div class="cushion"></div>


<!-- Create Modal -->
<div id="createSlideShoeModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">New Slideshow</h4>
      </div>
      <div class="modal-body">

        <%= form_tag(create_show_slideshows_path, method: "POST", class: "create-new-slideshow-form") do %>
          <div class="form-group">
            <label for="name">Slideshow Name</label>
            <input type="text" name="name" class='form-control'>
          </div>
          <div class="form-group">
            <label for="name">Phrase to populate with(leave blank to create an empty show)</label>
            <input type="text" name="phrase" class='form-control'>
          </div>

          <input type="submit" value='Create'>
        <% end %>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

<!-- Edit Modal -->
<div id="editSlideShowModal" class="modal fade" role="dialog"></div>

<script>
  $('body').on('submit', '.create-new-slideshow-form', function(event) {
    event.preventDefault();
    $('.current_slideshows').css('opacity', '.5');
    $.ajax({
      url: '/slideshows/create_show',
      type: 'POST',
      data: $(this).serialize(),
    })
    .done(function(data) {
      $('.current_slideshows').html(data);
      $('button.close').trigger('click');
      $('.current_slideshows').css('opacity', '1');
    })

  });

  // edit and update slideshow
  $('body').on('click', '.edit-this-show', function(event) {
    $('#editSlideShowModal').html("");
    $.ajax({
      url: '/users/edit_slideshow_modal',
      data: {id: $(this).attr('data-id')},
    })
    .done(function(data) {
      $('#editSlideShowModal').html(data);
    })
  });


    $('body').on('submit', '.edit-slideshow-form', function(event) {
    event.preventDefault();
    var action = $(this).attr('action');
    $('.current_slideshows').css('opacity', '.5');
    $.ajax({
      url: action,
      type: 'PUT',
      data: $(this).serialize(),
    })
    .done(function(data) {
      $('.current_slideshows').html(data);
      $('button.close').trigger('click');
      $('.current_slideshows').css('opacity', '1');
      $('#editSlideShowModal').html("");
    })
  });

</script>

